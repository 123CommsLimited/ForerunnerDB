ForerunnerDB.prototype.Plugin.Persist=function(){var d=function(){this.init.apply(this,arguments)};d.prototype.init=function(a){a.isClient()&&"undefined"!==typeof Storage&&this.mode("localStorage")};d.prototype.mode=function(a){return void 0!==a?(this._mode=a,this):this._mode};d.prototype.save=function(a,c,b){switch(this.mode()){case "localStorage":c="object"===typeof c?"json::fdb::"+JSON.stringify(c):"raw::fdb::"+c,localStorage.setItem(a,c),b&&b(!1)}b&&b("No data handler.")};d.prototype.load=function(a,
c){var b,d;switch(this.mode()){case "localStorage":b=localStorage.getItem(a);b=b.split("::fdb::");switch(b[0]){case "json":d=JSON.parse(b[1]);break;case "raw":d=b[1]}c&&c(!1,d)}c&&c("No data handler or unrecognised data type.")};var e=ForerunnerDB.classes.Collection;e.prototype.save=function(a){if(this._name)if(this._db)this._db.persist.save(this._name,this._data);else return a&&a("Cannot save a collection that is not attached to a database!"),"Cannot save a collection that is not attached to a database!";
else return a&&a("Cannot save a collection with no assigned name!"),"Cannot save a collection with no assigned name!"};e.prototype.load=function(a){var c=this;if(this._name)if(this._db)this._db.persist.load(this._name,function(b,d){if(b)return a&&a(b),b;c.setData(d);a&&a(!1)});else return a&&a("Cannot load a collection that is not attached to a database!"),"Cannot load a collection that is not attached to a database!";else return a&&a("Cannot load a collection with no assigned name!"),"Cannot load a collection with no assigned name!"};
return d}();
