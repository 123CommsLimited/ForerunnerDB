(function(){var f=function(g){g.prototype.Plugin.Remote=function(){var a=g.classes.Collection,f=a.prototype.find,k=a.prototype.insert,l=a.prototype.update,m=a.prototype.remove,n=a.prototype.setData;a.prototype.find=function(h,c,d){if(c&&c.remote){var b=this,a=arguments;b._db.remote.connected()?b._db.remote.send("find",{collection:b._name,query:h,options:c},function(b){d(b.err,b.result)}):setTimeout(function(){b.find.apply(b,a)},200)}else return f.apply(this,arguments)};a.prototype.insert=function(h,
c,d){if(c&&c.remote){var b=this,a=arguments;b._db.remote.connected()?b._db.remote.send("insert",{collection:b._name,query:h,options:c},function(b){d(b.err,b.result)}):setTimeout(function(){b.insert.apply(b,a)},200)}else return k.apply(this,arguments)};a.prototype.update=function(a,c,d,b){if(d&&d.remote){var e=this,p=arguments;e._db.remote.connected()?e._db.remote.send("update",{collection:e._name,query:a,update:c,options:d},function(a){b(a.err,a.result)}):setTimeout(function(){e.update.apply(e,p)},
200)}else return l.apply(this,arguments)};a.prototype.remove=function(a,c,d){if(c&&c.remote){var b=this,e=arguments;b._db.remote.connected()?b._db.remote.send("remove",{collection:b._name,query:a,options:c},function(b){d(b.err,b.result)}):setTimeout(function(){b.remove.apply(b,e)},200)}else return m.apply(this,arguments)};a.prototype.setData=function(a,c,d){if(c&&c.remote){var b=this,e=arguments;b._db.remote.connected()?b._db.remote.send("setData",{collection:b._name,query:a,options:c},function(b){d(b.err,
b.result)}):setTimeout(function(){b.setData.apply(b,e)},200)}else return n.apply(this,arguments)};a=function(a){this._db=a;this._collection={}};a.prototype.connect=function(a,c){var d=this;d._socket=io.connect(a);d._socket.on("connect",function(){d.connected(!0)})};a.prototype.connected=function(a){return void 0!==a?(this._connected=a,this):this._connected};a.prototype.authenticated=function(a){return void 0!==a?(this._authenticated=a,this):this._authenticated};a.prototype.send=function(a,c,d){this._socket.emit(a,
c,d)};a.prototype.auth=function(a,c){var d=this,b=arguments;d.connected()?d.send("auth",a,function(a){a.result&&d.authenticated(!0);c&&c(a.err,a.result)}):setTimeout(function(){d.auth.apply(d,b)},200)};return a}()};"function"===typeof define&&define.amd?define(["require","../ForerunnerDB"],function(g,a){return f(a)}):f(ForerunnerDB)})();
