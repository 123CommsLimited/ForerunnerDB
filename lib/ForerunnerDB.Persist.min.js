(function(){var e=function(f){f.prototype.Plugin.Persist=function(){var c=function(){this.init.apply(this,arguments)};c.prototype.init=function(a){a.isClient()&&"undefined"!==typeof Storage&&this.mode("localStorage")};c.prototype.mode=function(a){return void 0!==a?(this._mode=a,this):this._mode};c.prototype.save=function(a,d,b){switch(this.mode()){case "localStorage":d="object"===typeof d?"json::fdb::"+JSON.stringify(d):"raw::fdb::"+d,localStorage.setItem(a,d),b&&b(!1)}b&&b("No data handler.")};c.prototype.load=
function(a,d){var b,c;switch(this.mode()){case "localStorage":b=localStorage.getItem(a);b=b.split("::fdb::");switch(b[0]){case "json":c=JSON.parse(b[1]);break;case "raw":c=b[1]}d&&d(!1,c)}d&&d("No data handler or unrecognised data type.")};var e=f.classes.Collection;e.prototype.save=function(a){if(this._name)if(this._db)this._db.persist.save(this._name,this._data);else return a&&a("Cannot save a collection that is not attached to a database!"),"Cannot save a collection that is not attached to a database!";
else return a&&a("Cannot save a collection with no assigned name!"),"Cannot save a collection with no assigned name!"};e.prototype.load=function(a){var d=this;if(this._name)if(this._db)this._db.persist.load(this._name,function(b,c){if(b)return a&&a(b),b;d.setData(c);a&&a(!1)});else return a&&a("Cannot load a collection that is not attached to a database!"),"Cannot load a collection that is not attached to a database!";else return a&&a("Cannot load a collection with no assigned name!"),"Cannot load a collection with no assigned name!"};
return c}()};"function"===typeof define&&define.amd?define(["require","../ForerunnerDB"],function(f,c){return e(c)}):e(ForerunnerDB)})();
