(function(){var f=function(g){var c=g.classes.Collection,f=c.prototype.init,b=function(a,b){this.init.apply(this,arguments)};b.prototype.init=function(a,b){this._options=b;this._selector=$(this._options.selector);this._listeners={};this._collection=a;this._options.series=[];this._selector.highcharts(this._options.chartOptions);this._chart=this._selector.highcharts();var c=this._collection.find();switch(this._options.type){case "pie":var d={allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,
format:"<b>{point.name}</b>: {y} ({point.percentage:.0f}%)",style:{color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"}}},c=this.pieDataFromCollectionData(c,this._options.keyField,this._options.valField);$.extend(d,this._options.seriesOptions);$.extend(d,{type:"pie",name:this._options.seriesName,data:c});this._chart.addSeries(d)}this._hookEvents()};b.prototype.pieDataFromCollectionData=function(a,b,c){var d=[],e;for(e=0;e<a.length;e++)d.push([a[e][b],a[e][c]]);return d};b.prototype._hookEvents=
function(){var a=this;this._collection.on("change",function(){var b=a._collection.find();a._chart.series[0].setData(a.pieDataFromCollectionData(b,a._options.keyField,a._options.valField))});this._collection.on("drop",this._dropListener)};b.prototype._changeListener=function(){};b.prototype._dropListener=function(){this._collection.off("change",this._changeListener);this._collection.off("drop",this._dropListener)};b.prototype.drop=function(){this._chart.destroy();this._collection.off("change",this._changeListener);
this._collection.off("drop",this._dropListener);delete this._collection._highcharts[this._options.selector];delete this._chart;delete this._options;delete this._collection;return this};c.prototype.init=function(){this._highcharts={};f.apply(this,arguments)};c.prototype.chart=function(a){this._highcharts[a.selector]||(this._highcharts[a.selector]=new b(this,a));return this._highcharts[a.selector]};c.prototype.dropChart=function(a){this._highcharts[a]&&this._highcharts[a].drop()};g.classes.Highchart=
b};"function"===typeof define&&define.amd?define(["require","../ForerunnerDB"],function(g,c){return f(c)}):f(ForerunnerDB)})();
