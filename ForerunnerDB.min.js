ForerunnerDB.js:684: WARNING - unreachable code
		if (options && options.template) {
		^

0 error(s), 1 warning(s)
var ForerunnerDB=function(){var t=0,r=function(a){return a.replace(/([ #;?%&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")},s=function(a){a&&this.path(a)};s.prototype.path=function(a){return void 0!==a?(this._path=this.clean(a),this._pathParts=this._path.split("."),this):this._path};s.prototype.parse=function(a,b){var c="",e,d;for(d in a)if(a.hasOwnProperty(d)){c+=d;"object"===typeof a[d]?b?(e=this.parse(a[d],b),c+="."+e.path,e=e.value):c+="."+this.parse(a[d],b):b&&(e=a[d]);break}return b?{path:c,value:e}:{path:c}};
s.prototype.value=function(a){var b=this._pathParts,c=b.length,e;for(e=0;e<c&&!(a=a[b[e]],!a||"object"!==typeof a);e++);return a};s.prototype.clean=function(a){"."===a.substr(0,1)&&(a=a.substr(1,a.length-1));return a};var p=function(a){this._name=a;this._collectionArr=[];this._views=[];this._primaryKey="_id"};p.prototype.on=function(a,b){this._listeners[a]=this._listeners[a]||[];this._listeners[a].push(b);return this};p.prototype.off=function(a,b){if(a in this._listeners){var c=this._listeners[a],
e=c.indexOf(b);-1<e&&c.splice(e,1)}return this};p.prototype.emit=function(a,b){this._listeners=this._listeners||{};if(a in this._listeners){var c=this._listeners[a],e=c.length,d;for(d=0;d<e;d++)c[d].apply(this,Array.prototype.slice.call(arguments,1))}return this};p.prototype.db=function(a){return void 0!==a?(this._db=a,this):this._db};p.prototype.addCollection=function(a){a&&-1===this._collectionArr.indexOf(a)&&(this._collectionArr.push(a),a._groups.push(this));return this};p.prototype.removeCollection=
function(a){if(a){var b=this._collectionArr.indexOf(a);-1!==b&&(this._collectionArr.splice(b,1),b=a._groups.indexOf(this),-1!==b&&a._groups.splice(b,1))}return this};p.prototype.find=function(a,b){var c,e;for(e=0;e<this._collectionArr.length;e++)if(c=this._collectionArr[e].find(a,b),c.length)return c;return[]};p.prototype.insert=function(a,b){for(var c=0;c<this._collectionArr.length;c++)this._collectionArr[c].insert(a,b)};p.prototype.update=function(a,b){for(var c=0;c<this._collectionArr.length;c++)this._collectionArr[c].update(a,
b)};p.prototype.updateById=function(a,b){for(var c=0;c<this._collectionArr.length;c++)this._collectionArr[c].updateById(a,b)};p.prototype.remove=function(a){for(var b=0;b<this._collectionArr.length;b++)this._collectionArr[b].remove(a)};p.prototype.removeById=function(a){for(var b=0;b<this._collectionArr.length;b++)this._collectionArr[b].removeById(a)};p.prototype._addView=function(a){void 0!==a&&(this._views[a._name]=a);return this};p.prototype._removeView=function(a){void 0!==a&&delete this._views[a._name];
return this};p.prototype.subset=function(a,b){var c=this.find(a,b);return(new h)._subsetOf(this).primaryKey(this._primaryKey).setData(c)};var h=function(a){this._primaryKey="_id";this._name=a;this._data=[];this._binds={};this._views=[];this._groups=[];this._subsetOf(this)};h.prototype.on=function(a,b){this._listeners[a]=this._listeners[a]||[];this._listeners[a].push(b);return this};h.prototype.off=function(a,b){if(a in this._listeners){var c=this._listeners[a],e=c.indexOf(b);-1<e&&c.splice(e,1)}return this};
h.prototype.emit=function(a,b){this._listeners=this._listeners||{};if(a in this._listeners){var c=this._listeners[a],e=c.length,d;for(d=0;d<e;d++)c[d].apply(this,Array.prototype.slice.call(arguments,1))}return this};h.prototype.drop=function(){if(this._db&&this._name){(this._debug||this._db&&this._db._debug)&&console.log("Dropping collection "+this._name);delete this._db._collection[this._name];var a=[],b;for(b=0;b<this._groups.length;b++)a.push(this._groups[b]);for(b=0;b<a.length;b++)this._groups[b].removeCollection(this);
return!0}return!1};h.prototype.primaryKey=function(a){return void 0!==a?(this._primaryKey=a,this):this._primaryKey};h.prototype._addView=function(a){void 0!==a&&(this._views[a._name]=a);return this};h.prototype._removeView=function(a){void 0!==a&&delete this._views[a._name];return this};h.prototype._onInsert=function(a,b){var c=this._binds,e=this._views,d=this.find({}),f,g;for(g in c)c.hasOwnProperty(g)&&(f=c[g].reduce?this.find(c[g].reduce.query,c[g].reduce.options):d,this._fireInsert(g,c[g],a,b,
f));for(g in e)e.hasOwnProperty(g)&&e[g]._onCollectionInsert(a,b);this.emit("insert",a,b)};h.prototype._onUpdate=function(a){var b=this._binds,c=this._views,e=this.find({}),d,f;for(f in b)b.hasOwnProperty(f)&&(d=b[f].reduce?this.find(b[f].reduce.query,b[f].reduce.options):e,this._fireUpdate(f,b[f],a,d));for(f in c)c.hasOwnProperty(f)&&c[f]._onCollectionUpdate(a);this.emit("update",a)};h.prototype._onRemove=function(a){var b=this._binds,c=this._views,e=this.find({}),d,f;for(f in b)b.hasOwnProperty(f)&&
(d=b[f].reduce?this.find(b[f].reduce.query,b[f].reduce.options):e,this._fireRemove(f,b[f],a,d));for(f in c)c.hasOwnProperty(f)&&c[f]._onCollectionRemove(a);this.emit("remove",a)};h.prototype._fireInsert=function(a,b,c,e,d){var f=$(a),g;for(g=0;g<c.length;g++)a=f.find("#"+r(c[g][this._primaryKey])),a.length||b.template(c[g],function(a,c,d,e){return function(a){b.insert?b.insert(a,c,d,e):b.prependInsert?f.prepend(a):f.append(a);b.afterInsert&&b.afterInsert(a,c,d,e)}}(a,c[g],e,d))};h.prototype._fireUpdate=
function(a,b,c,e){var d=$(a),f;for(f=0;f<c.length;f++)a=d.find("#"+r(c[f][this._primaryKey])),b.template(c[f],function(a,c){return function(f){b.update?b.update(f,c,e,a.length?"update":"append"):a.length?a.replaceWith(f):b.prependUpdate?d.prepend(f):d.append(f);b.afterUpdate&&b.afterUpdate(f,c,e)}}(a,c[f]))};h.prototype._fireRemove=function(a,b,c,e){a=$(a);var d,f;for(f=0;f<c.length;f++)d=a.find("#"+r(c[f][this._primaryKey])),d.length&&(b.beforeRemove?b.beforeRemove(d,c[f],e,function(a,c,d){return function(){b.remove?
b.remove(a,c,d):(a.remove(),b.afterRemove&&b.afterRemove(a,c,d))}}(d,c[f],e)):b.remove?b.remove(d,data,e):(d.remove(),b.afterRemove&&b.afterRemove(d,c[f],e)))};h.prototype.bind=function(a,b){throw"Binds against collections are now deprecated, use views instead!";};h.prototype.unBind=function(a){delete this._binds[a];return this};h.prototype.db=function(a){return void 0!==a?(this._db=a,this):this._db};h.prototype.on=function(){var a=$(this);a.on.apply(a,arguments);return this};h.prototype.off=function(){var a=
$(this);a.off.apply(a,arguments);return this};h.prototype.setData=function(a){a&&(this._data=[],this._data=this._data.concat(a),this._onUpdate(this._data));return this};h.prototype.truncate=function(){this._onRemove(this._data);this._data.length=0;return this};h.prototype.upsert=function(a){var b={},c;if(a instanceof Array){b=[];for(c=0;c<a.length;c++)b.push(this.upsert(a[c]));return b}a[this._primaryKey]?(c={},c[this._primaryKey]=a[this._primaryKey],this.count(c).length?b.op="update":b.op="insert"):
b.op="insert";switch(b.op){case "insert":b.result=this.insert(a);break;case "update":b.result=this.update(c,a)}return b};h.prototype.update=function(a,b){var c=this,e=this.find(a,{decouple:!1}),d,f=function(d){return c._updateObject(d,b,a)};e.length&&(d=e.filter(f),d.length&&this._onUpdate(d));return d||[]};h.prototype.updateById=function(a,b){var c={};c[this._primaryKey]=a;return this.update(c,b)};h.prototype._updateObject=function(a,b,c,e){e=e||"";"."===e.substr(0,1)&&(e=e.substr(1,e.length-1));
var d=!1,f=!1,g,h,m,k,n;for(k in b)if(b.hasOwnProperty(k)){g=!1;if("$"===k.substr(0,1))switch(k){case "$inc":g=!0;for(n in b[k])if(b[k].hasOwnProperty(n))if("number"===typeof a[n])a[n]+=b[k][n],d=!0;else throw"Cannot increment field that is not a number! ("+n+")!";break;case "$push":g=!0;for(n in b[k])if(b[k].hasOwnProperty(n))if(a[n]instanceof Array)a[n].push(b[k][n]),d=!0;else throw"Cannot push to a key that is not an array! ("+n+")!";break;case "$pull":for(n in g=!0,b[k])if(b[k].hasOwnProperty(n))if(a[n]instanceof
Array){h=[];for(m=0;m<a[n].length;m++)this._match(a[n][m],b[k][n])&&h.push(m);for(m=h.length;m--;)a[n].splice(h[m],1),d=!0}else throw"Cannot pull from a key that is not an array! ("+n+")!";}if(".$"===k.substr(k.length-2,2)&&(g=!0,k=k.substr(0,k.length-2),f=new s(e+"."+k),a[k]&&a[k]instanceof Array&&a[k].length)){h=[];for(m=0;m<a[k].length;m++)this._match(a[k][m],f.value(c))&&h.push(m);for(m=0;m<h.length;m++)(f=this._updateObject(a[k][h[m]],b[k+".$"],c,e+"."+k))&&(d=!0)}if(!g)if("object"===typeof b[k])if(null!==
a[k]&&"object"===typeof a[k])if(g=a[k]instanceof Array,h=b[k]instanceof Array,g||h)if(!h&&g)for(m=0;m<a[k].length;m++)(f=this._updateObject(a[k][m],b[k],c,e+"."+k))&&(d=!0);else a[k]=b[k],d=!0;else(f=this._updateObject(a[k],b[k],c,e+"."+k))&&(d=!0);else a[k]=b[k],d=!0;else a[k]!==b[k]&&(a[k]=b[k],d=!0)}return d};h.prototype.remove=function(a){a=this.find(a,{decouple:!1});var b;if(a.length){for(var c=0;c<a.length;c++)b=this._data.indexOf(a[c]),this._data.splice(b,1);this._onRemove(a)}return a};h.prototype.removeById=
function(a){var b={};b[this._primaryKey]=a;return this.remove(b)};h.prototype.insert=function(a){var b=[],c=[],e,d;if(a instanceof Array)for(d=0;d<a.length;d++)e=this._insert(a[d]),!0===e?b.push(a[d]):c.push({doc:a[d],reason:e});else e=this._insert(a),!0===e?b.push(a):c.push({doc:a,reason:e});this._onInsert(b,c);return{inserted:b,failed:c}};h.prototype._insert=function(a){return a&&!this._indexViolation(a)?(this._data.push(a),!0):!1};h.prototype._indexViolation=function(a){a=this.findById(a[this._primaryKey]);
return Boolean(a)};h.prototype.subset=function(a,b){var c=this.find(a,b);return(new h)._subsetOf(this).primaryKey(this._primaryKey).setData(c)};h.prototype.subsetOf=function(){return this.__subsetOf};h.prototype._subsetOf=function(a){this.__subsetOf=a;return this};h.prototype.decouple=function(a){return JSON.parse(JSON.stringify(a))};h.prototype.findById=function(a,b){var c={};c[this._primaryKey]=a;return this.find(c,b)[0]};h.prototype.find=function(a,b){a=a||{};b=b||{};b.decouple=void 0!==b.decouple?
b.decouple:!0;var c,e=this,d,f,g,h,m,k,n,l,p,q,r=[];h=function(b){return e._match(b,a,"and")};if(a){c=this._analyseQuery(a,b);if(c.hasJoin&&c.queriesJoin)for(d=0;d<c.joinsOn.length;d++)g=c.joinsOn[d],f=new s(c.joinQueries[g]),f=f.value(a),this._db.collection(c.joinsOn[d]).subset(f);c=this._data.filter(h);b.sort&&(c=this.sort(b.sort,c));b.limit&&(c.length=b.limit);b.decouple&&(c=this.decouple(c));if(b.join)for(d=0;d<b.join.length;d++)for(g in b.join[d])if(b.join[d].hasOwnProperty(g)){p=g;h=this._db.collection(g);
f=b.join[d][g];for(q=0;q<c.length;q++){k={};l=n=!1;for(m in f)if(f.hasOwnProperty(m))if("$"===m.substr(0,1))switch(m){case "$as":p=f[m];break;case "$multi":n=f[m];break;case "$require":l=f[m]}else k[m]=(new s(f[m])).value(c[q]);k=h.find(k);!l||l&&k[0]?c[q][p]=!1===n?k[0]:k:r.push(c[q])}}for(m=0;m<r.length;m++)g=c.indexOf(r[m]),-1<g&&c.splice(g,1);return c}return[]};h.prototype.sort=function(a,b){b=b||[];var c=new s,e=c.parse(a,!0);c.path(e.path);return b.sort(1===e.value?function(a,b){var e=c.value(a),
h=c.value(b);return e>h?1:e<h?-1:0}:function(a,b){var e=c.value(a),h=c.value(b);return e>h?-1:e<h?1:0})};h.prototype._analyseQuery=function(a,b){var c={queriesOn:[this._name],usesIndex:[],hasJoin:!1,queriesJoin:!1,joinQueries:{}},e,d,f=[],g=[];if(b.join){c.hasJoin=!0;for(e=0;e<b.join.length;e++)for(d in b.join[e])b.join[e].hasOwnProperty(d)&&(f.push(d),"$as"in b.join[e][d]?g.push(b.join[e][d].$as):g.push(d));for(d=0;d<g.length;d++)if(e=this._queryReferencesCollection(a,g[d],""))c.joinQueries[f[d]]=
e,c.queriesJoin=!0;c.joinsOn=f;c.queriesOn=c.queriesOn.concat(f)}return c};h.prototype._queryReferencesCollection=function(a,b,c){for(var e in a)if(a.hasOwnProperty(e)){if(e===b)return c&&(c+="."),c+e;if("object"===typeof a[e])return c&&(c+="."),c+=e,this._queryReferencesCollection(a[e],b,c)}return!1};h.prototype._match=function(a,b,c){if(this._debug)debugger;var e,d;e=typeof a;d=typeof b;var f=!0,g;if(("string"===e||"number"===e)&&("string"===d||"number"===d))a!==b&&(f=!1);else for(g in b)if(b.hasOwnProperty(g)){e=
!1;if("$"===g.substr(0,1))switch(g){case "$gt":if(a>b[g]){if("or"===c)return!0}else f=!1;e=!0;break;case "$gte":if(a>=b[g]){if("or"===c)return!0}else f=!1;e=!0;break;case "$lt":if(a<b[g]){if("or"===c)return!0}else f=!1;e=!0;break;case "$lte":if(a<=b[g]){if("or"===c)return!0}else f=!1;e=!0;break;case "$exists":if(void 0===a!==b[g]){if("or"===c)return!0}else f=!1;e=!0;break;case "$or":e=!0;for(d=0;d<b[g].length;d++){if(this._match(a,b[g][d],"and"))return!0;f=!1}break;case "$and":e=!0;for(d=0;d<b[g].length;d++)if(!this._match(a,
b[g][d],"and"))return!1}if(!e&&b[g]instanceof RegExp)if(e=!0,"object"===typeof a&&void 0!==a[g]&&b[g].test(a[g])){if("or"===c)return!0}else f=!1;if(!e)if("object"===typeof b[g])if(void 0!==a[g]){if(a[g]instanceof Array&&!(b[g]instanceof Array)){e=!1;for(d=0;d<a[g].length&&!(e=this._match(a[g][d],b[g],void 0));d++);}else if(!(a[g]instanceof Array)&&b[g]instanceof Array){e=!1;for(d=0;d<b[g].length&&!(e=this._match(a[g],b[g][d],void 0));d++);}else e="object"===typeof a?this._match(a[g],b[g],void 0):
this._match(void 0,b[g],void 0);if(e){if("or"===c)return!0}else f=!1}else if(void 0!==b[g].$exists)if(e=this._match(void 0,b[g],void 0)){if("or"===c)return!0}else f=!1;else f=!1;else if(a&&a[g]===b[g]){if("or"===c)return!0}else f=!1;if("and"===c&&!f)return!1}return f};h.prototype.count=function(a,b){return a?this.find(a,b).length:this._data.length};var l=function(a){this._name=a;this._binds=[];this._listeners={};this._query={query:{},options:{}}};l.prototype.on=function(a,b){this._listeners[a]=this._listeners[a]||
[];this._listeners[a].push(b);return this};l.prototype.off=function(a,b){if(a in this._listeners){var c=this._listeners[a],e=c.indexOf(b);-1<e&&c.splice(e,1)}return this};l.prototype.emit=function(a,b){this._listeners=this._listeners||{};if(a in this._listeners){var c=this._listeners[a],e=c.length,d;for(d=0;d<e;d++)c[d].apply(this,Array.prototype.slice.call(arguments,1))}return this};l.prototype.drop=function(){return(this._db||this._from)&&this._name?((this._debug||this._from&&this._from._debug||
this._db&&this._db._debug)&&console.log("Dropping view "+this._name),this._db&&delete this._db._views[this._name],this._from&&delete this._from._views[this._name],!0):!1};l.prototype.db=function(a){return void 0!==a?(this._db=a,this):this._db};l.prototype.from=function(a){if(void 0!==a){if(this._from!==a)if(this._from&&this._from._removeView(this),a instanceof h||a instanceof p?this._from=a:"string"===typeof a&&(this._from=this._db.collection(a)),this._from)this._from._addView(this),this._primaryKey=
this._from._primaryKey,this.refresh();else throw"Cannot determine collection type in view.from()";return this}return this._from};l.prototype.query=function(a,b,c){void 0!==a&&(this._query.query=a);void 0!==b&&(this._query.options=b);return void 0!==a||void 0!==b?((void 0===c||!0===c)&&this.refresh(),this):this._query};l.prototype.queryAdd=function(a,b,c){var e=this._query.query,d;if(void 0!==a)for(d in a)if(a.hasOwnProperty(d)&&(void 0===e[d]||void 0!==e[d]&&b))e[d]=a[d];(void 0===c||!0===c)&&this.refresh()};
l.prototype.queryRemove=function(a,b){var c=this._query.query,e;if(void 0!==a)for(e in a)a.hasOwnProperty(e)&&delete c[e];(void 0===b||!0===b)&&this.refresh()};l.prototype.queryObj=function(a,b){return void 0!==a?(this._query.query=a,(void 0===b||!0===b)&&this.refresh(),this):this._query.query};l.prototype.queryOptions=function(a,b){return void 0!==a?(this._query.options=a,(void 0===b||!0===b)&&this.refresh(),this):this._query.options};l.prototype.refresh=function(a){var b=this._data,c,e,d,f,g,h=
[],m=[],k=[],n=this._binds,l,p;this._from&&(this._data=this._query?this._from.subset(this._query.query,this._query.options):this._from.subset({}));if(a)for(l in a=this._data.find(),this._onInsert(a,[]),n)n.hasOwnProperty(l)&&(b=n[l],b.maintainSort&&this.sortDomBind(l,a),b.afterOperation&&b.afterOperation());else if(b)if(d=this._data,b.subsetOf()===d.subsetOf()){a=d.find();c=b.find();f=d._primaryKey;for(p=0;p<a.length;p++)g=a[p],e={},e[f]=g[f],(e=b.find(e)[0])?JSON.stringify(e)!==JSON.stringify(g)&&
m.push(g):h.push(g);for(p=0;p<c.length;p++)g=c[p],e={},e[f]=g[f],d.find(e)[0]||k.push(g);h.length&&this._onInsert(h,[]);m.length&&this._onUpdate(m);k.length&&this._onRemove(k);for(l in n)n.hasOwnProperty(l)&&(b=n[l],b.maintainSort&&this.sortDomBind(l,a),b.afterOperation&&b.afterOperation())}else k=b.find(),k.length&&this._onRemove(k),h=d.find(),h.length&&this._onInsert(h);return this};l.prototype.render=function(a,b){var c=this._binds[a],e=$(a),d,f,g=$("<ul></ul>"),h;if(c){d=this._data.find();for(h=
0;h<d.length;h++)f=d[h],c.template(f,function(a){g.append(a)});b?b(a,g.html()):e.append(g.html())}};l.prototype.count=function(){return this._data&&this._data._data?this._data._data.length:0};l.prototype.find=function(){return this._data?this._data.find.apply(this._data,arguments):[]};l.prototype.bind=function(a,b){if(b&&b.template)this._binds[a]=b;else throw"Cannot bind data to element, missing options information!";return this};l.prototype.unBind=function(a){delete this._binds[a];return this};l.prototype.sortDomBind=
function(a,b){var c=$(a),e,d;for(e=0;e<b.length;e++)d=b[e],d=c.find("#"+d[this._primaryKey]),0===e?c.prepend(d):d.insertAfter(c.children(":eq("+(e-1)+")"))};l.prototype._onCollectionInsert=function(a,b){this.refresh()};l.prototype._onInsert=function(a,b){var c=this._binds,e=this.find({}),d,f;for(f in c)c.hasOwnProperty(f)&&(d=c[f].reduce?this.find(c[f].reduce.query,c[f].reduce.options):e,this._fireInsert(f,c[f],a,b,d));this.emit("insert",a,b)};l.prototype._onCollectionUpdate=function(a){this.refresh()};
l.prototype._onUpdate=function(a){var b=this._binds,c=this.find({}),e,d;for(d in b)b.hasOwnProperty(d)&&(e=b[d].reduce?this.find(b[d].reduce.query,b[d].reduce.options):c,this._fireUpdate(d,b[d],a,e));this.emit("update",a)};l.prototype._onCollectionRemove=function(a){this.refresh()};l.prototype._onRemove=function(a){var b=this._binds,c=this.find({}),e,d;for(d in b)b.hasOwnProperty(d)&&(e=b[d].reduce?this.find(b[d].reduce.query,b[d].reduce.options):c,this._fireRemove(d,b[d],a,e));this.emit("remove",
a)};l.prototype._fireInsert=function(a,b,c,e,d){var f=$(a),g;for(g=0;g<c.length;g++)a=f.find("#"+r(c[g][this._primaryKey])),a.length||b.template(c[g],function(a,c,d,e){return function(a){b.insert?b.insert(a,c,d,e):b.prependInsert?f.prepend(a):f.append(a);b.afterInsert&&b.afterInsert(a,c,d,e)}}(a,c[g],e,d))};l.prototype._fireUpdate=function(a,b,c,e){var d=$(a),f;for(f=0;f<c.length;f++)a=d.find("#"+r(c[f][this._primaryKey])),b.template(c[f],function(a,c){return function(f){b.update?b.update(f,c,e,a.length?
"update":"append"):a.length?a.replaceWith(f):b.prependUpdate?d.prepend(f):d.append(f);b.afterUpdate&&b.afterUpdate(f,c,e)}}(a,c[f]))};l.prototype._fireRemove=function(a,b,c,e){a=$(a);var d,f;for(f=0;f<c.length;f++)d=a.find("#"+r(c[f][this._primaryKey])),d.length&&(b.beforeRemove?b.beforeRemove(d,c[f],e,function(a,c,d){return function(){b.remove?b.remove(a,c,d):(a.remove(),b.afterRemove&&b.afterRemove(a,c,d))}}(d,c[f],e)):b.remove?b.remove(d,c[f],e):(d.remove(),b.afterRemove&&b.afterRemove(d,c[f],
e)))};var u=function(a){t++;this._val=a?a:(t+(Math.random()*Math.pow(10,17)+Math.random()*Math.pow(10,17)+Math.random()*Math.pow(10,17)+Math.random()*Math.pow(10,17))).toString(24)};u.prototype.toString=function(){return this._val};var q=function(){this._collection={};this._collectionGroup={};this._views={};for(var a in this.Plugin)this.Plugin.hasOwnProperty(a)&&(this[a.substr(0,1).toLowerCase()+a.substr(1,a.length-1)]=new this.Plugin[a](this))};q.prototype.debug=function(a){return void 0!==a?(this._debug=
a,this):this._debug};q.types={Path:s,Collection:h,CollectionGroup:p,ObjectId:u};q.prototype.arrayToCollection=function(a){return(new h).setData(a)};q.prototype.on=function(){var a=$(this);a.on.apply(a,arguments)};q.prototype.off=function(){var a=$(this);a.off.apply(a,arguments)};q.prototype.collectionGroup=function(a){return a?(this._collectionGroup[a]=this._collectionGroup[a]||(new p(a)).db(this),this._collectionGroup[a]):this._collectionGroup};q.prototype.collection=function(a,b){if(a)return this._collection[a]||
(this._debug||this._db&&this._db._debug)&&console.log("Creating collection "+a),this._collection[a]=this._collection[a]||(new h(a)).db(this),void 0!==b&&this._collection[a].primaryKey(b),this._collection[a];throw"Cannot get collection with undefined name!";};q.prototype.view=function(a){this._views[a]||this._debug&&console.log("Creating view "+a);this._views[a]=this._views[a]||(new l(a)).db(this);return this._views[a]};q.prototype.viewExists=function(a){return Boolean(this._views[a])};q.prototype.collectionExists=
function(a){return Boolean(this._collection[a])};q.prototype.collections=function(){var a=[],b;for(b in this._collection)this._collection.hasOwnProperty(b)&&a.push({name:b,count:this._collection[b].count()});return a};q.prototype.views=function(){var a=[],b;for(b in this._views)this._views.hasOwnProperty(b)&&a.push({name:b,count:this._views[b].count()});return a};q.prototype.Plugin={};return q}();"undefined"!==typeof module&&"undefined"!==typeof module.exports&&(module.exports=ForerunnerDB);
